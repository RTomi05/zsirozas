<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Zs√≠roz√°s ‚Äì val√≥di lapokkal</title>

<style>
body {
    background:#063;
    font-family: Arial;
    color:white;
}

.hand, .table {
    display:flex;
    gap:10px;
    margin:10px 0;
}

.card {
    width:256px;
    height:341px;
    border-radius:10px;
    cursor:pointer;
    border:2px solid transparent;
}

.card img {
    width:100%;
    height:100%;
    border-radius:10px;
}

.card:hover {
    border-color:yellow;
}

.disabled {
    opacity:0.4;
    pointer-events:none;
}

.area {
    background:#0005;
    padding:10px;
    border-radius:8px;
}
</style>
</head>

<body>

<h1>üÉè Zs√≠roz√°s ‚Äì tov√°bb√ºt√©ssel</h1>

<div class="area">
    <b>Akt√≠v j√°t√©kos:</b> <span id="player"></span>
</div>

<h3>Asztal</h3>
<div class="table" id="table"></div>

<h3>J√°t√©kos 1</h3>
<div class="hand" id="hand0"></div>

<h3>J√°t√©kos 2</h3>
<div class="hand" id="hand1"></div>

<script>
const suits = ["z√∂ld","sz√≠v","t√∂k","makk"];
const values = ["7","8","9","10","als√≥","fels≈ë","kir√°ly","√°sz"];

const suitMap = {
    "z√∂ld": "level",
    "sz√≠v": "sziv",
    "t√∂k": "tok",
    "makk": "makk"
};

const valueMap = {
    "7":"7",
    "8":"8",
    "9":"9",
    "10":"10",
    "als√≥":"also",
    "fels≈ë":"felso",
    "kir√°ly":"kiraly",
    "√°sz":"asz"
};

function cardImage(c){
    return `cards/${suitMap[c.s]}${valueMap[c.v]}.png`;
}

let deck=[], hands=[[],[]], table=[];
let current=0;
let lastAttacker=null;
let beatActive=false;

function makeDeck(){
    deck=[];
    suits.forEach(s=>{
        values.forEach(v=>{
            deck.push({s,v});
        });
    });
}

function shuffle(a){
    for(let i=a.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
    }
}

function deal(){
    for(let i=0;i<2;i++)
        while(hands[i].length<4 && deck.length)
            hands[i].push(deck.pop());
}

function isSeven(c){ return c.v==="7"; }
function sameValue(a,b){ return a.v===b.v; }

function canBeat(card){
    const last=table[table.length-1];
    return sameValue(card,last) || isSeven(card);
}

function play(p,idx){
    if(p!==current) return;

    const card=hands[p].splice(idx,1)[0];

    if(beatActive && !canBeat(card)){
        takeTable(lastAttacker);
        return;
    }

    table.push(card);

    if(table.length>=2 && canBeat(card)){
        lastAttacker=p;
        beatActive=true;
        current=1-p;
    }
    else if(table.length>=2){
        takeTable(1-p);
        return;
    }
    else{
        current=1-p;
    }

    render();
}

function takeTable(p){
    table=[];
    beatActive=false;
    lastAttacker=null;
    deal();
    current=p;
    render();
}

function cardDiv(c,p,i){
    const d=document.createElement("div");
    d.className="card";

    const img=document.createElement("img");
    img.src = cardImage(c);
    img.alt = `${c.s} ${c.v}`;

    d.appendChild(img);

    if(p!==undefined) d.onclick=()=>play(p,i);
    return d;
}

function render(){
    document.getElementById("player").textContent="J√°t√©kos "+(current+1);

    document.getElementById("table").innerHTML="";
    document.getElementById("hand0").innerHTML="";
    document.getElementById("hand1").innerHTML="";

    table.forEach(c=>{
        document.getElementById("table").appendChild(cardDiv(c));
    });

    hands.forEach((h,p)=>{
        h.forEach((c,i)=>{
            const d=cardDiv(c,p,i);
            if(p!==current) d.classList.add("disabled");
            document.getElementById("hand"+p).appendChild(d);
        });
    });
}

// start
makeDeck();
shuffle(deck);
deal();
render();
</script>

</body>
</html>
